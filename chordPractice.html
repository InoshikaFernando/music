<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Chord Scale Excercise</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      text-align: center;
      margin: 0;
      padding: 40px 20px;
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #4a90e2 100%);
      min-height: 100vh;
      color: white;
    }
    
    h1 {
      color: #ffffff;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      margin-bottom: 30px;
      font-size: 2.5em;
      font-weight: 300;
    }
    
    label {
      color: #e8f4fd;
      font-weight: 500;
      margin: 0 10px;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
    }
    
    select {
      background: linear-gradient(145deg, #ffffff, #f0f8ff);
      border: 2px solid #4a90e2;
      border-radius: 8px;
      padding: 8px 12px;
      margin: 0 10px;
      font-size: 14px;
      color: #2a5298;
      font-weight: 500;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
    }
    
    select:hover {
      border-color: #2a5298;
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
      transform: translateY(-1px);
    }
    
    select:focus {
      outline: none;
      border-color: #1e3c72;
      box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.3);
    }
    
    button {
      background: linear-gradient(145deg, #4a90e2, #2a5298);
      color: white;
      border: none;
      border-radius: 25px;
      padding: 12px 24px;
      margin: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    button:hover {
      background: linear-gradient(145deg, #2a5298, #1e3c72);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(74, 144, 226, 0.4);
    }
    
    button:active {
      transform: translateY(0);
      box-shadow: 0 2px 10px rgba(74, 144, 226, 0.3);
    }
    
    table {
      border-collapse: separate;
      border-spacing: 8px;
      margin: 30px auto;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      backdrop-filter: blur(10px);
    } 
    
    td { 
      border: 3px solid #4a90e2;
      border-radius: 12px;
      width: 180px; 
      height: 100px; 
      vertical-align: middle;
      background: linear-gradient(145deg, #ffffff, #f8fbff);
      box-shadow: inset 0 2px 4px rgba(74, 144, 226, 0.1);
      transition: all 0.3s ease;
    }
    
    td:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(74, 144, 226, 0.2);
    }
    
    .beat {
      display: inline-block;
      width: 30px;
      height: 20px;
      margin: 5px auto;
      border: 2px solid #4a90e2;
      border-radius: 8px;
      line-height: 20px;
      text-align: center;
      font-weight: bold;
      background: linear-gradient(145deg, #ffffff, #f0f8ff);
      color: #2a5298;
      font-size: 12px;
      transition: all 0.2s ease;
      box-shadow: 0 2px 4px rgba(74, 144, 226, 0.1);
    }
    
    .beat:hover {
      transform: scale(1.05);
      box-shadow: 0 3px 6px rgba(74, 144, 226, 0.2);
    }
    
    .active1 {
      background: linear-gradient(145deg, #87ceeb, #4a90e2);
      color: white;
      animation: pulse1 0.5s ease-in-out;
      box-shadow: 0 0 15px rgba(135, 206, 235, 0.6);
    }
    
    .active2 {
      background: linear-gradient(145deg, #4a90e2, #2a5298);
      color: white;
      animation: pulse2 0.5s ease-in-out;
      box-shadow: 0 0 15px rgba(74, 144, 226, 0.6);
    }
    
    .emoji {
      font-size: 2em;
      line-height: 1;
      filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.1));
    }

    #guitar {
      background: linear-gradient(145deg, #e6f3ff, #cce7ff);
      border-color: #87ceeb;
      color: #1e3c72;
      font-weight: 600;
      text-shadow: 1px 1px 2px rgba(255,255,255,0.8);
    }
    
    #violin {
      background: linear-gradient(145deg, #f0f8ff, #e6f3ff);
      border-color: #4a90e2;
      color: #1e3c72;
      font-weight: 600;
      text-shadow: 1px 1px 2px rgba(255,255,255,0.8);
    }
    
    @keyframes pulse1 {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
    
    @keyframes pulse2 {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
    
    /* Back button styling */
    button[onclick] {
      background: linear-gradient(145deg, #6c757d, #495057);
      font-size: 14px;
      padding: 10px 20px;
      margin-top: 30px;
    }
    
    button[onclick]:hover {
      background: linear-gradient(145deg, #495057, #343a40);
    }
  </style>
</head>
<body>
  <h1>Chord/ Scale Exercise</h1>

  <label>Tempo (BPM):</label>
  <select id="tempo">
    <option value="60">60</option>
    <option value="80">80</option>
    <option value="100" selected>100</option>
    <option value="120">120</option>
    <option value="140">140</option>
  </select>

  <label>Time Signature:</label>
  <select id="timeSignature">
    <option value="2">2/4</option>
    <option value="3">3/4</option>
    <option value="4" selected>4/4</option>
  </select>

  <label style="margin-left:20px; color:white;">Chord Progression:</label>
  <select id="chordSelector">
    <option value="2" selected>2 chords</option>
    <option value="3">3 chords</option>
    <option value="4">4 chords</option>
  </select>

  <button id="playBtn">‚ñ∂ Play</button>
  <button id="stopBtn">‚èπ Stop</button>

  <table>
    <tr id="row1"></tr>
    <tr id="row2"></tr>
  </table>
  
  <button onclick="location.href='index.html'">‚Üê Back to Music Collection</button>
  <script>
    const chordLevel = document.getElementById("chords");
    
    // const chords = ["C", "C", "G", "G"]; // Example chords
    // Chord progressions for each option
    const chordProgressions = {
      2: ["C", "G", "C", "G"],
      3: ["C", "D", "G", "D"],
      4: ["C", "D", "Em", "G"]
    };

    const chordSelector = document.getElementById("chordSelector");
    // Set initial chords
    let chords = chordProgressions[chordSelector.value];

    // Update chords and re-render bars on selection
    chordSelector.addEventListener("change", () => {
      chords = chordProgressions[chordSelector.value];
      renderBars();
    });
    const row1 = document.getElementById("row1");
    const row2 = document.getElementById("row2");
    const playBtn = document.getElementById("playBtn");
    const stopBtn = document.getElementById("stopBtn");
    const tempoSelect = document.getElementById("tempo");
    const timeSignatureSelect = document.getElementById("timeSignature");

    let interval, currentBeat = 0;
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function renderBars() {
      row1.innerHTML = "<td id='guitar'> <span class='emoji'>üé∏</span> Guitar chords </td>";
      row2.innerHTML = "<td id='violin'> <span class='emoji'>üéª</span> Violin notes </td>";
      const beatsPerBar = parseInt(timeSignatureSelect.value);
      chords.forEach((chord, barIndex) => {
        const td = document.createElement("td");
        for (let i = 0; i < beatsPerBar; i++) {
          const beatDiv = document.createElement("div");
          beatDiv.className = "beat";
          beatDiv.textContent = chord;
          beatDiv.id = `bar${barIndex}-beat${i}`;
          td.appendChild(beatDiv);
        }
        row1.appendChild(td);
      });
      chords.forEach((chord, barIndex) => {
        const td = document.createElement("td");
        for (let i = 0; i < beatsPerBar; i++) {
          const beatDiv = document.createElement("div");
          beatDiv.className = "beat";
          if (chord === "C") {
            if (i === 0) {
              beatDiv.textContent = "C"; //
              console.log(beatDiv.textContent);
            }
            else if (i === 1) {
              beatDiv.textContent = "D"; //
              console.log(beatDiv.textContent);
            }
            else if (i === 2) {
              beatDiv.textContent = "E"; //
              console.log(beatDiv.textContent);
            }
            else {
              beatDiv.textContent = "F"; //
              console.log(beatDiv.textContent);
            }
          }
          if (chord === "D") {
            if (i === 0) {
              beatDiv.textContent = "D"; //
              console.log(beatDiv.textContent);
            }
            else if (i === 1) {
              beatDiv.textContent = "E"; //
              console.log(beatDiv.textContent);
            }
            else if (i === 2) {
              beatDiv.textContent = "F"; //
              console.log(beatDiv.textContent);
            }
            else {
              beatDiv.textContent = "G"; //
              console.log(beatDiv.textContent);
            }
          }
          if (chord === "Em") {
            if (i === 0) {
              beatDiv.textContent = "E"; //
              console.log(beatDiv.textContent);
            }
            else if (i === 1) {
              beatDiv.textContent = "F"; //
              console.log(beatDiv.textContent);
            }
            else if (i === 2) {
              beatDiv.textContent = "G"; //
              console.log(beatDiv.textContent);
            }
            else {
              beatDiv.textContent = "A"; //
              console.log(beatDiv.textContent);
            }
          }
          if (chord === "G") {
            if (i === 0) {
              beatDiv.textContent = "G"; //
              console.log(beatDiv.textContent);
            }
            else if (i === 1) {
              beatDiv.textContent = "A"; //
              console.log(beatDiv.textContent);
            }
            else if (i === 2) {
              beatDiv.textContent = "B"; //
              console.log(beatDiv.textContent);
            }
            else {
              beatDiv.textContent = "C"; //
              console.log(beatDiv.textContent);
            }
          }
          beatDiv.id = `note${barIndex}-beat${i}`;
          td.appendChild(beatDiv);
        }
        row2.appendChild(td);
      });
    }

    function playClick(isStrong) {
      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();
      osc.connect(gain);
      gain.connect(audioCtx.destination);
      osc.frequency.value = isStrong ? 880 : 440;
      gain.gain.value = 0.2;
      osc.start();
      osc.stop(audioCtx.currentTime + 0.1);
    }

    function startPlayback() {
      stopPlayback();
      const bpm = parseInt(tempoSelect.value);
      const beatDuration = (60 / bpm) * 1000;
      const beatsPerBar = parseInt(timeSignatureSelect.value);
      const totalBeats = chords.length * beatsPerBar;
      currentBeat = 0;

      interval = setInterval(() => {
        document.querySelectorAll(".beat").forEach(el => el.classList.remove("active1"));
        document.querySelectorAll(".beat").forEach(el => el.classList.remove("active2"));
        const barIndex = Math.floor(currentBeat / beatsPerBar);
        const beatIndex = currentBeat % beatsPerBar;
        const activeDiv1 = document.getElementById(`bar${barIndex}-beat${beatIndex}`);
        const activeDiv2 = document.getElementById(`note${barIndex}-beat${beatIndex}`);
        if (activeDiv1) activeDiv1.classList.add("active1");
        if (activeDiv2) activeDiv2.classList.add("active2");

        playClick(beatIndex === 0); // strong click on first beat

        currentBeat = (currentBeat + 1) % totalBeats;
      }, beatDuration);
    }

    function stopPlayback() {
      clearInterval(interval);
      document.querySelectorAll(".beat").forEach(el => el.classList.remove("active1"));
      document.querySelectorAll(".beat").forEach(el => el.classList.remove("active2"));
      currentBeat = 0;
    }

    timeSignatureSelect.addEventListener("change", renderBars);
    playBtn.addEventListener("click", () => {
      audioCtx.resume();
      startPlayback();
    });
    stopBtn.addEventListener("click", stopPlayback);

    renderBars();
  </script>
</body>
</html>
